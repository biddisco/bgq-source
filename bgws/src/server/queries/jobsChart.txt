-- JOBS_CHART

WITH all AS (

SELECT startTime
  FROM bgqJob_history
  WHERE startTime > CURRENT_TIMESTAMP - 6 DAYS

UNION ALL

SELECT startTime
  FROM bgqJob
  WHERE startTime > CURRENT_TIMESTAMP - 6 DAYS

)

SELECT CURRENT_DATE - 4 DAYS AS d1,
       COALESCE( SUM( CASE WHEN DATE( startTime ) = CURRENT_DATE - 4 DAYS THEN 1 ELSE 0 END ), 0 ) AS j1,
       CURRENT_DATE - 3 DAYS AS d2,
       COALESCE( SUM( CASE WHEN DATE( startTime ) = CURRENT_DATE - 3 DAYS THEN 1 ELSE 0 END ), 0 ) AS j2,
       CURRENT_DATE - 2 DAYS AS d3,
       COALESCE( SUM( CASE WHEN DATE( startTime ) = CURRENT_DATE - 2 DAYS THEN 1 ELSE 0 END ), 0 ) AS j3,
       CURRENT_DATE - 1 DAYS AS d4,
       COALESCE( SUM( CASE WHEN DATE( startTime ) = CURRENT_DATE - 1 DAYS THEN 1 ELSE 0 END ), 0 ) AS j4,
       CURRENT_DATE          AS d5,
       COALESCE( SUM( CASE WHEN DATE( startTime ) = CURRENT_DATE - 0 DAYS THEN 1 ELSE 0 END ), 0 ) AS j5
  FROM all
